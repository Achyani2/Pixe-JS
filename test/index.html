<!DOCTYPE html>
<html>
<head>
    <style>
        body, html { margin: 0; padding: 0; }
        canvas { position: fixed; }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/4.0.0/pixi.min.js"></script>
    <script src="../bin/pixi-ui.js"></script>
    <title></title>
    <meta charset="utf-8" />
</head>
<body>
    <script type="text/javascript">
        var renderer = new PIXI.WebGLRenderer(window.innerWidth, window.innerHeight);
        var stage = new PIXI.Container();
        var uiStage = new PIXI.UI.Stage(window.innerWidth, window.innerHeight);
        var dragContainer = new PIXI.UI.Container();
        document.body.appendChild(renderer.view);
        stage.addChild(uiStage);

        window.addEventListener("resize", function () {
            renderer.resize(window.innerWidth, window.innerHeight);
            uiStage.resize(window.innerWidth, window.innerHeight);
        });

        PIXI.loader.add('UISprites.json').load(function () {
            init();
        });

        var playersArr = [
            { name: "Alex", score: 1000, kills: 15, deaths: 4, assist: 6, ping: 75 },
            { name: "John", score: 132, kills: 1, deaths: 2, assist: 1, ping: 25 },
            { name: "Charles", score: 595, kills: 9, deaths: 6, assist: 4, ping: 50 },
            { name: "Ivan", score: 705, kills: 10, deaths: 5, assist: 3, ping: 33 },
            { name: "Martin", score: 130, kills: 2, deaths: 7, assist: 7, ping: 21 },
            { name: "Ronnie", score: 10, kills: 0, deaths: 1, assist: 1, ping: 55 },
            { name: "Jimmy", score: 1500, kills: 17, deaths: 1, assist: 8, ping: 55 },
            { name: "Egon", score: 1132, kills: 5, deaths: 3, assist: 5, ping: 25 },
            { name: "Ulrik", score: 595, kills: 9, deaths: 8, assist: 4, ping: 58 },
            { name: "Peter", score: 705, kills: 10, deaths: 3, assist: 4, ping: 33 },
            { name: "Nick", score: 1130, kills: 15, deaths: 5, assist: 3, ping: 247 },
            { name: "Andy", score: 17, kills: 0, deaths: 2, assist: 2, ping: 59 }
        ];



        function init() {
            var whiteBG = PIXI.Texture.fromFrame("UI/ui-box-1.png");
            var innerBG = PIXI.Texture.fromFrame("UI/ui-box-2.png");
            var lineSprite = PIXI.Texture.fromFrame("UI/ui-horizontal-line-border.png");
            var horizontalGradient = PIXI.Texture.fromFrame("UI/horizontal-gradient.png");


            window["lb"] = leaderboardWrapper = new PIXI.UI.Container();
            leaderboardWrapper.horizontalAlign = "center";
            leaderboardWrapper.verticalAlign = "middle";
            leaderboardWrapper.height = "90%";
            leaderboardWrapper.width = "95%";
            uiStage.addChild(leaderboardWrapper);

            var container = new PIXI.UI.SliceSprite(whiteBG, 5);
            container.height = 600;
            container.width = '80%';
            container.maxWidth = 1200;
            container.minWidth = 550;
            container.maxHeight = "100%";
            container.horizontalAlign = "center";
            container.verticalAlign = "middle";
            leaderboardWrapper.addChild(container);

            for (var i = 0; i < 2; i++) {
                var section = new PIXI.UI.Container();
                if (i == 1) section.anchorRight = 0;
                section.anchorBottom = 0;
                section.anchorTop = 0;
                section.width = "50%";
                container.addChild(section);

                var teamContainer = new PIXI.UI.SliceSprite(innerBG, 5);
                teamContainer.anchorTop = teamContainer.anchorBottom = 6;
                teamContainer.anchorRight = i == 1 ? 6 : 3;
                teamContainer.anchorLeft = i == 1 ? 3 : 6;
                teamContainer.tint = i == 1 ? 0x3b0000 : 0x252934;
                section.addChild(teamContainer);



                var headlineStyle = { fill: i == 1 ? ['#ff6c6c', '#ff3838'] : ['#5ebef2', '#26aff1'], fontSize: 18, fontFamily: 'Calibri', fontWeight: 'bold' };
                var HeadlinePlayer = new PIXI.UI.Text("PLAYER", headlineStyle);
                var HeadlineScore = new PIXI.UI.Text("SCORE", headlineStyle);
                var HeadlineKDA = new PIXI.UI.Text("K/D/A", headlineStyle);
                var HeadlinePing = new PIXI.UI.Text("PING", headlineStyle);
                HeadlinePlayer.anchorTop = HeadlineScore.anchorTop = HeadlineKDA.anchorTop = HeadlinePing.anchorTop = 19;
                HeadlinePlayer.left = 13;
                HeadlineScore.right = "55%";
                HeadlineKDA.right = "33%";
                HeadlinePing.anchorRight = "2%";

                var headlineStroke = new PIXI.UI.SliceSprite(lineSprite, 2, true, false);
                headlineStroke.tint = i == 1 ? 0xff6c6c : 0x76c3f2;
                headlineStroke.anchorLeft = headlineStroke.anchorRight = 8;
                headlineStroke.anchorTop = 37;


                var ScrollingContainer = new PIXI.UI.ScrollingContainer("100%", "100%", false, false, 0);
                var sortableList = new PIXI.UI.SortableList(true);
                sortableList.anchorTop = 40;
                sortableList.anchorBottom = 1;
                sortableList.width = "100%";
                ScrollingContainer.addChild(sortableList);
                sortableList.droppable = true;
                sortableList.dragGroup = "player";


                var textStyle = { fill: ['#ffffff', '#ededed'], fontSize: 14, fontFamily: 'Calibri', fontWeight: 'bold' };
                for (var p = 0; p < playersArr.length; p++) {
                    (function () {
                        var player = playersArr[p];
                        var playerItem = new PIXI.UI.Container();
                        playerItem.draggable = true;
                        playerItem.dragGroup = "player";
                        playerItem.dragContainer = dragContainer;
                        playerItem.anchorLeft = 0;
                        playerItem.anchorRight = 0;
                        playerItem.height = 40;


                        var playerItemUnderline = new PIXI.UI.SliceSprite(lineSprite, 2, true, false);
                        playerItemUnderline.anchorLeft = playerItemUnderline.anchorRight = 10;
                        playerItemUnderline.anchorBottom = 0;
                        playerItemUnderline.alpha = 0.7;


                        var playerItemBG = new PIXI.UI.Sprite(horizontalGradient);
                        playerItemBG.anchorLeft = playerItemBG.anchorRight = 10;
                        playerItemBG.anchorTop = 0;
                        playerItemBG.anchorBottom = 3;
                        playerItemBG.blendMode = 1;

                        var Name = new PIXI.UI.Text(player.name, textStyle);
                        var Score = new PIXI.UI.Text(player.score, textStyle);
                        var KDA = new PIXI.UI.Text(player.kills + "/" + player.deaths + "/" + player.assist, textStyle);
                        var Ping = new PIXI.UI.Text(player.ping, textStyle);

                        Name.anchorTop = Score.anchorTop = KDA.anchorTop = Ping.anchorTop = 6;
                        Name.left = 13;
                        Score.right = "55%";
                        KDA.right = "33%";
                        Ping.anchorRight = "2%";

                        playerItem.addChild(playerItemBG, playerItemUnderline, Name, Score, KDA, Ping);
                        playerItem.altering = function (alt) {
                            if (alt) playerItemBG.alpha = 0;
                            else playerItemBG.alpha = 0.08;
                        };


                        sortableList.addChild(playerItem,
                            function () {
                                return player.score;
                            },
                            function () {
                                return player.kills;
                            });
                    })();
                }

                teamContainer.addChild(HeadlinePlayer, HeadlineScore, HeadlineKDA, HeadlinePing, headlineStroke, ScrollingContainer);
            }

            uiStage.addChild(dragContainer);

            Update();
        }

        function Update() {
            renderer.render(stage);
            requestAnimationFrame(Update);
        }

    </script>
</body>
</html>
